(this["webpackJsonpairtime-calculator"]=this["webpackJsonpairtime-calculator"]||[]).push([[0],{101:function(e,a,t){},186:function(e,a,t){},188:function(e,a,t){},190:function(e,a,t){},191:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(16),c=t.n(r),i=t(40),o=t.n(i),s=t(62),u=t(9),m=t(63),d=t.n(m),f=t(10),E=t(75),v=t(17),h=t(64),p=t.n(h),g=t(73),b=t(6),y=(t(101),t(25)),R=t(72),z=t(41),w=t.n(z),j=t(68),S=t(69),N=t(15),C=[{name:"LinkCheckReq",size:0},{name:"LinkAdrAns",size:1},{name:"DutyCycleAns",size:0},{name:"RXParamSetupAns",size:1},{name:"DevStatusAns",size:2},{name:"NewChannelAns",size:1},{name:"DlChannelAns",size:1},{name:"RXTimingSetupAns",size:0},{name:"TxParamSetupAns",size:0}],k=[{name:"LinkCheckAns",size:2},{name:"LinkAdrReq",size:4},{name:"DutyCycleReq",size:1},{name:"RXParamSetupReq",size:4},{name:"DevStatusReq",size:0},{name:"NewChannelReq",size:5},{name:"DlChannelReq",size:4},{name:"RXTimingSetupReq",size:1},{name:"TxParamSetupReq",size:1}],O=t(76),x=t(66),A=t(65);function L(e){var a=e.content,t=e.showIcon,r=void 0!==t&&t,c=e.placement,i=void 0===c?"top":c,o=e.children,s=Object(n.useState)((function(){return Object(A.uniqueId)("HelpTooltip-")})),m=Object(u.a)(s,1)[0];return a?l.a.createElement(O.a,{placement:i,overlay:l.a.createElement(x.a,{id:m},a)},l.a.createElement("div",null,o,r&&l.a.createElement("sup",null,l.a.createElement("small",{className:"text-muted"},"\u24d8")))):l.a.createElement(l.a.Fragment,null,o)}function P(e){return{value:""+e.value,onChange:function(a){var t=a.currentTarget;e.setValue("number"===typeof e.value?+t.value:t.value)}}}var T=t(28),F=t(29);t(186);function I(e){var a=e.min,t=void 0===a?0:a,r=e.value,c=e.setValue;return Object(n.useEffect)((function(){c(r)}),[r,c]),l.a.createElement(F.a,{className:"mb-3"},l.a.createElement(F.a.Prepend,null,l.a.createElement(y.a,{onClick:function(){r>t&&c(r-1)},variant:"outline-secondary","aria-label":"Decrease"},"-")),l.a.createElement(T.a,Object.assign({},P({value:r,setValue:c}),{type:"number",className:"NumberInput",min:t,placeholder:"Enter number"})),l.a.createElement(F.a.Append,null,l.a.createElement(y.a,{onClick:function(){c((function(e){return e+1}))},variant:"outline-secondary","aria-label":"Increase"},"+")))}var M=t(77),D=t(44),q=t(67),_={payloadSize:12,headerSize:13,codingRate:"4/5"};function W(e){function a(e){var a=Object(n.useState)(e),t=Object(u.a)(a,2);return{value:t[0],setValue:t[1]}}var t=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={},n=a.split(",").map((function(e){return e.trim()})),l=Object(q.a)(n);try{var r=function(){var a=e.value;if(""===a)return"continue";if(/^\d+$/.test(a))return t.payloadSize?t.headerSize?console.warn("Ignored numeric value ".concat(a,"; already parsed both payloadSize and headerSize")):t.headerSize=+a:t.payloadSize=+a,"continue";if(/^cr4[5678]$/i.test(a))return t.codingRate?console.warn("Ignored string value ".concat(a,"; already parsed codingRate")):t.codingRate=a.substr(2).split("").join("/"),"continue";var n=a.toLowerCase(),l=C.concat(k).find((function(e){return e.name.toLowerCase()===n}));l?t.macCommands=(t.macCommands||[]).concat(l):console.warn("Ignored string value ".concat(a,"; no matching MAC command found"))};for(l.s();!(e=l.n()).done;)r()}catch(c){l.e(c)}finally{l.f()}return Object(D.a)(Object(D.a)({},_),t)}(e.userConfig),r=a(t.payloadSize),c=a(t.headerSize),i=a(t.codingRate),o=a(t.macCommands);function s(e){var a;o.setValue((o.value||[]).concat(e)),a=e.size+1,c.setValue((function(e){return e+a}))}Object(n.useEffect)((function(){e.setPacketSize(c.value+r.value)}),[e,c.value,r.value]),Object(n.useEffect)((function(){e.setCodingRate(i.value)}),[e,i.value]),Object(n.useEffect)((function(){e.setUserConfig(function(e,a,t,n){var l=[];return e===_.payloadSize&&a===_.headerSize||l.push(e),a!==_.headerSize&&l.push(a),t&&t!==_.codingRate&&l.push("cr"+t.replace("/","")),n&&l.push.apply(l,Object(M.a)(n.map((function(e){return e.name})))),l.join(",")}(r.value,c.value,i.value,o.value))}),[e,c.value,r.value,i.value,o.value]);var m=C.map((function(e,a){return l.a.createElement("div",{key:a},l.a.createElement(j.a,{onClick:function(){return s(e)},pill:!0,variant:t.macCommands&&t.macCommands.includes(e)?"primary":"secondary"},e.name," ",e.size),"\xa0")}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a,null,l.a.createElement(N.a.Row,null,l.a.createElement(N.a.Group,{as:f.a,controlId:"formHeaderSize"},l.a.createElement(L,{showIcon:!0,content:"For a LoRaWAN 1.0.x uplink and downlink, the header is at least 13 bytes: Type (1), DevAddr (4), FCtrl (1), FCnt (2), FPort (1) and MIC (4)."},l.a.createElement(N.a.Label,null,"Header size")),l.a.createElement(I,Object.assign({},c,{min:13}))),l.a.createElement(N.a.Group,{as:f.a,controlId:"formApplicationPayloadSize"},l.a.createElement(L,{showIcon:!0,content:"The application payload size. Might be empty for a simple ACK or if the packet only includes MAC commands."},l.a.createElement(N.a.Label,null,"Payload size")),l.a.createElement(I,r)),l.a.createElement(N.a.Group,{as:f.a,controlId:"formCodingRate"},l.a.createElement(L,{showIcon:!0,content:"The coding rate (CR) used for forward error correction (FEC)."},l.a.createElement(N.a.Label,null,"Coding rate")),l.a.createElement(N.a.Control,Object.assign({as:"select"},P(i)),l.a.createElement("option",{value:"4/5"},"4/5"),l.a.createElement("option",{value:"4/6"},"4/6"),l.a.createElement("option",{value:"4/7"},"4/7"),l.a.createElement("option",{value:"4/8"},"4/8")))),t.macCommands&&l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a.Row,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},l.a.createElement(N.a.Label,null,"MAC command"),l.a.createElement(S.a,{"aria-label":"MAC commands"},m))),l.a.createElement("br",null))))}var V=t(70),U=t(71),B=function(){function e(){Object(V.a)(this,e)}return Object(U.a)(e,null,[{key:"calculate",value:function(e,a,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"4/5",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"auto",r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:8,i=Math.pow(2,a)/(1e3*t)*1e3,o=(c+4.25)*i,s=r?0:1,u="auto"===l&&125===+t&&+a>=11||!0===l?1:0,m=+n[2]-4,d=8+Math.max(Math.ceil((8*e-4*a+28+16-20*s)/(4*(a-2*u)))*(m+4),0),f=d*i;return o+f}}]),e}();function X(e,a){return e.toLocaleString("en-US",{minimumFractionDigits:a,maximumFractionDigits:a})}function G(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.reduce((function(e,a){return a?e+(e&&"."!==e.slice(-1)?". ":e?" ":"")+a+(e&&"."!==a.slice(-1)?".":""):e}),"")||void 0}function H(e){var a=e.dr,t=e.size,n=e.airtime,r=e.maxPhyPayloadSize,c=e.maxDwellTime,i=void 0===c?0:c,o=n/.01/1e3,s=3e4/n,u=86400/s,m=i>0&&n>i,d=a.maxMacPayloadSize&&t>r;return l.a.createElement(l.a.Fragment,null,l.a.createElement(L,{content:G(a.notes,a.maxMacPayloadSize&&(d?"The full payload of ".concat(t," bytes exceeds the maximum packet size of ").concat(r," bytes"):"Maximum total packet size ".concat(r," bytes")))},l.a.createElement("div",{className:"Result-datarate ".concat(d?"Result-has-warning":a.notes?"Result-has-note":"")},l.a.createElement("div",{className:"Result-dr"},a.name),l.a.createElement("div",null,l.a.createElement("span",{className:"Result-sf"},"SF",a.sf),l.a.createElement("span",{className:"Result-unit Result-unit-bw"},"BW",l.a.createElement("br",null),a.bw)),d&&l.a.createElement("div",{className:"Result-datarate-warning"},"max size exceeded"))),l.a.createElement(L,{content:G("".concat(X(n,3)," milliseconds time on air"),m&&"This exceeds the maximum dwell time of ".concat(i," milliseconds"))},l.a.createElement("div",{className:"Result-airtime ".concat(m?"Result-has-warning":"")},l.a.createElement("div",null,X(n,1),l.a.createElement("span",{className:"Result-unit"},"ms")),m&&l.a.createElement("div",{className:"Result-airtime-warning"},"max dwell time exceeded"))),l.a.createElement(L,{content:l.a.createElement(l.a.Fragment,null,"If regional legal or LoRaWAN maximum duty cycles apply, then a 1% maximum duty cycle needs a ",l.a.createElement("em",null,"minimum")," of ",X(o,3)," seconds between ",l.a.createElement("em",null,"any")," subsequent packet starts in the same subband.")},l.a.createElement("div",{className:"Result-dutycycle"},l.a.createElement("div",null,X(o,1),l.a.createElement("span",{className:"Result-unit"},"sec")),l.a.createElement("div",null,X(Math.floor(3600/o),0),l.a.createElement("span",{className:"Result-unit"},"msg",l.a.createElement("br",null),"/hour")))),l.a.createElement(L,{content:l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,"The TTN Fair Access Policy allows for at most 30 seconds time on air per device, per 24 hours. An airtime of ",X(n,3),"\xa0ms thus yields a maximum of"," ",X(s,1)," messages."),l.a.createElement("p",null,"When transmitting all day, this translates to, ",l.a.createElement("em",null,"on average"),", a minimum of"," ",X(u,1)," seconds between the starts of two uplinks, or a maximum of"," ",X(s/24,1),"\xa0messages per hour."))},l.a.createElement("div",{className:"Result-fairaccess"},l.a.createElement("div",{className:"Result-fairaccess-messages"},X(86400/s,1),l.a.createElement("span",{className:"Result-unit"},"sec",l.a.createElement("br",null),"(avg)")),l.a.createElement("div",null,l.a.createElement("span",{className:"Result-fairaccess-messages-per-hour"},X(s/24,1)),l.a.createElement("span",{className:"Result-unit Result-unit-hour"},"avg",l.a.createElement("br",null),"/hour")),l.a.createElement("div",{className:"Result-fairaccess-messages-per-day"},X(Math.floor(s),0),l.a.createElement("span",{className:"Result-unit"},"msg",l.a.createElement("br",null),"/24h")))))}function $(e){var a=e.region,t=e.packetSize,n=e.codingRate;if(!n)return null;var r=a.dataRates.map((function(e,r){var c=B.calculate(t,e.sf,e.bw,n),i=e.maxMacPayloadSize+5,o=a.maxDwellTime&&c>a.maxDwellTime||e.maxMacPayloadSize&&t>i,s="Results-result-".concat(r%2?"odd":"even"),u="Results-result-highlight-".concat(o?"warning":e.highlight||"none");return l.a.createElement("div",{key:e.name,className:"Results-result ".concat(s," ").concat(u)},l.a.createElement(H,{size:t,dr:e,airtime:c,maxPhyPayloadSize:i,maxDwellTime:a.maxDwellTime}))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"Results-grid Results-grid-".concat(r.length)},l.a.createElement("div",{className:"Results-legend"},l.a.createElement("div",null,"data rate"),l.a.createElement("div",null,"airtime"),l.a.createElement("div",null,"1%\xa0max duty\xa0cycle"),l.a.createElement("div",null,"fair access policy")),r))}t(188);function J(e){var a=e.children,t=Object(n.useRef)(null),r=Object(n.useState)(!1),c=Object(u.a)(r,2),i=c[0],o=c[1],s=Object(n.useState)(!1),m=Object(u.a)(s,2),d=m[0],f=m[1],E=Object(n.useState)({width:-1,height:-1}),v=Object(u.a)(E,1)[0],h=function(e){var a=t.current;a&&a.scrollBy(e,0)};return Object(n.useEffect)((function(){var e=t.current,a=function(){if(e){var a=e.scrollLeft>0,t=e.scrollWidth-e.offsetWidth>e.scrollLeft+1;o(a),f(t)}else console.log("No scroll element")};if(e)return a(),window.addEventListener("resize",a),e.addEventListener("scroll",a),function(){e.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}),[v]),l.a.createElement("div",{className:"d-flex justify-content-center align-items-center horizontal-scroll"+(i?" horizontal-scroll--overflow-left":"")+(d?" horizontal-scroll--overflow-right":"")},l.a.createElement("div",{className:"horizontal-scroll__button"+(i?" horizontal-scroll__button--enabled":""),onClick:function(){h(-40)}},"\u2039"),l.a.createElement("div",{className:"horizontal-scroll__content table-responsive",ref:t},a),l.a.createElement("div",{className:"horizontal-scroll__button"+(d?" horizontal-scroll__button--enabled":""),onClick:function(){h(40)}},"\u203a"))}function K(e,a,t){var n=a.pathname.split("/"),l=Object(u.a)(n,4),r=l[1],c=l[2],i=l[3],o=t.networks.find((function(e){return e.name===r})),s=o?o.regions.find((function(e){return e.name===c})):void 0;return{network:o,region:s,parameters:i}}function Q(e,a,t,n,l,r){var c=K(0,a,t),i=void 0===r?c.parameters:r,o="/"+n.name+"/"+l.name+(i?"/"+i:"");a.pathname!==o?e.replace(o):console.log("No URL change needed; ".concat(o))}function Y(e){var a=Object(n.useState)(null),t=Object(u.a)(a,2),r=t[0],c=t[1],i=Object(n.useState)(null),o=Object(u.a)(i,2),s=o[0],m=o[1],d=Q.bind(null,e.history,e.location,e.config),E=K(e.history,e.location,e.config),h=E.network,p=E.region,g=E.parameters;if(!h){var b=e.config.networks[0],z=b.regions.find((function(e){return e.name===b.defaultRegion}));return d(b,z),null}if(!p){var j=h.regions.find((function(e){return e.name===h.defaultRegion}));return d(h,j),null}return l.a.createElement(l.a.Fragment,null,l.a.createElement(v.a,null,l.a.createElement(f.a,null,l.a.createElement(J,null,l.a.createElement(R.a,null,h.regions.map((function(e){return l.a.createElement(y.a,{variant:"outline-primary",size:"sm",active:e.name===p.name,disabled:!e.dataRates,key:e.name,onClick:function(){return function(e){console.log("region",e),d(h,e)}(e)}},e.label)})))))),l.a.createElement(v.a,null,l.a.createElement("hr",null)),l.a.createElement(v.a,{className:"justify-content-sm-center"},l.a.createElement(f.a,null,l.a.createElement("h3",null,p.title))),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"auto"},l.a.createElement(W,{userConfig:g,setUserConfig:function(e){console.log("URL",e),d(h,p,e)},setPacketSize:function(e){console.log("packet size",r,e),c(e)},setCodingRate:function(e){console.log("coding rate",s,e),m(e)}}))),l.a.createElement(v.a,{className:"justify-content-sm-center"},l.a.createElement(f.a,null,l.a.createElement($,{region:p,packetSize:r,codingRate:s}),l.a.createElement("hr",null))),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},p.limitations&&l.a.createElement(w.a,{source:p.limitations}))),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},p.countries&&l.a.createElement(w.a,{source:p.countries}))))}function Z(){var e="/airtime-calculator/config.json",a=Object(n.useState)("Loading configuration..."),t=Object(u.a)(a,2),r=t[0],c=t[1],i=Object(n.useState)({}),m=Object(u.a)(i,2),h=m[0],y=m[1];return Object(n.useEffect)((function(){var a=!1;return function(){var t=Object(s.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.a.get(e);case 3:n=t.sent.data,a||(c(null),y(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),c("Failed to load configuration ".concat("/airtime-calculator"," ").concat(e,": ").concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}()(),function(){a=!0}}),[e]),l.a.createElement(g.a,{basename:"/airtime-calculator"},l.a.createElement(E.a,{fluid:!0,className:"App"},l.a.createElement(v.a,null,l.a.createElement(f.a,null,l.a.createElement("h1",null,"Airtime calculator for LoRaWAN"),l.a.createElement("p",null,r))),h.networks&&l.a.createElement(b.a,{render:function(e){return l.a.createElement(Y,Object.assign({},e,{config:h}))}}),l.a.createElement(p.a,{href:"https://github.com/avbentem/airtime-calculator"})))}t(190),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},78:function(e,a,t){e.exports=t(191)}},[[78,1,2]]]);
//# sourceMappingURL=main.1b99553c.chunk.js.map