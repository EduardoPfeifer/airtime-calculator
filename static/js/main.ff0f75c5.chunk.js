(this["webpackJsonplorawan-airtime-ui"]=this["webpackJsonplorawan-airtime-ui"]||[]).push([[0],{184:function(e,a,t){},187:function(e,a,t){},188:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(16),c=t.n(r),i=t(42),o=t.n(i),s=t(62),u=t(10),m=t(63),d=t.n(m),f=t(9),E=t(74),v=t(18),p=t(64),g=t.n(p),h=t(72),b=t(6),y=(t(99),t(27)),R=t(71),z=t(65),w=t.n(z),j=t(67),C=t(68),N=t(15),S=[{name:"LinkCheckReq",size:0},{name:"LinkAdrAns",size:1},{name:"DutyCycleAns",size:0},{name:"RXParamSetupAns",size:1},{name:"DevStatusAns",size:2},{name:"NewChannelAns",size:1},{name:"DlChannelAns",size:1},{name:"RXTimingSetupAns",size:0},{name:"TxParamSetupAns",size:0}],k=[{name:"LinkCheckAns",size:2},{name:"LinkAdrReq",size:4},{name:"DutyCycleReq",size:1},{name:"RXParamSetupReq",size:4},{name:"DevStatusReq",size:0},{name:"NewChannelReq",size:5},{name:"DlChannelReq",size:4},{name:"RXTimingSetupReq",size:1},{name:"TxParamSetupReq",size:1}],O=t(23),x=t(22);function A(e){var a=e.text,t=e.placement,n=void 0===t?"bottom":t;return a?l.a.createElement("sup",null,l.a.createElement(O.a,{placement:n,overlay:l.a.createElement(x.a,{id:"todo"},a)},l.a.createElement("small",{className:"text-muted"},"\u24d8"))):null}function L(e){return{value:""+e.value,onChange:function(a){var t=a.currentTarget;e.setValue("number"===typeof e.value?+t.value:t.value)}}}var F=t(30),M=t(31);function P(e){var a=e.min,t=void 0===a?0:a,r=e.value,c=e.setValue;return Object(n.useEffect)((function(){c(r)}),[r,c]),l.a.createElement(M.a,{className:"mb-3"},l.a.createElement(M.a.Prepend,null,l.a.createElement(y.a,{onClick:function(){r>t&&c(r-1)},variant:"outline-secondary","aria-label":"Decrease"},"-")),l.a.createElement(F.a,Object.assign({},L({value:r,setValue:c}),{type:"number",min:t,placeholder:"Enter number"})),l.a.createElement(M.a.Append,null,l.a.createElement(y.a,{onClick:function(){c((function(e){return e+1}))},variant:"outline-secondary","aria-label":"Increase"},"+")))}var T=t(75),q=t(45),D=t(66),I={payloadSize:6,headerSize:13,codingRate:"4/5"};function _(e){function a(e){var a=Object(n.useState)(e),t=Object(u.a)(a,2);return{value:t[0],setValue:t[1]}}var t=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={},n=a.split(",").map((function(e){return e.trim()})),l=Object(D.a)(n);try{var r=function(){var a=e.value;if(""===a)return"continue";if(/^\d+$/.test(a))return t.payloadSize?t.headerSize?console.warn("Ignored numeric value ".concat(a,"; already parsed both payloadSize and headerSize")):t.headerSize=+a:t.payloadSize=+a,"continue";if(/^cr4[5678]$/i.test(a))return t.codingRate?console.warn("Ignored string value ".concat(a,"; already parsed codingRate")):t.codingRate=a.substr(2).split("").join("/"),"continue";var n=a.toLowerCase(),l=S.concat(k).find((function(e){return e.name.toLowerCase()===n}));l?t.macCommands=(t.macCommands||[]).concat(l):console.warn("Ignored string value ".concat(a,"; no matching MAC command found"))};for(l.s();!(e=l.n()).done;)r()}catch(c){l.e(c)}finally{l.f()}return Object(q.a)(Object(q.a)({},I),t)}(e.userConfig),r=a(t.payloadSize),c=a(t.headerSize),i=a(t.codingRate),o=a(t.macCommands);function s(e){var a;o.setValue((o.value||[]).concat(e)),a=e.size+1,c.setValue((function(e){return e+a}))}Object(n.useEffect)((function(){e.setPacketSize(c.value+r.value)}),[e,c.value,r.value]),Object(n.useEffect)((function(){e.setCodingRate(i.value)}),[e,i.value]),Object(n.useEffect)((function(){e.setUserConfig(function(e,a,t,n){var l=[];return e===I.payloadSize&&a===I.headerSize||l.push(e),a!==I.headerSize&&l.push(a),t&&t!==I.codingRate&&l.push("cr"+t.replace("/","")),n&&l.push.apply(l,Object(T.a)(n.map((function(e){return e.name})))),l.join(",")}(r.value,c.value,i.value,o.value))}),[e,c.value,r.value,i.value,o.value]);var m=S.map((function(e,a){return l.a.createElement("div",{key:a},l.a.createElement(j.a,{onClick:function(){return s(e)},pill:!0,variant:t.macCommands&&t.macCommands.includes(e)?"primary":"secondary"},e.name," ",e.size),"\xa0")}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a,null,l.a.createElement(N.a.Row,null,l.a.createElement(N.a.Group,{as:f.a,controlId:"formHeaderSize"},l.a.createElement(N.a.Label,null,"Header size",l.a.createElement(A,{text:"For a LoRaWAN 1.0.x uplink and downlink, the header is at least 13 bytes: Type (1), DevAddr (4), FCtrl (1), FCnt (2), FPort (1) and MIC (4)."})),l.a.createElement(P,Object.assign({},c,{min:13}))),l.a.createElement(N.a.Group,{as:f.a,controlId:"formApplicationPayloadSize"},l.a.createElement(N.a.Label,null,"Payload size",l.a.createElement(A,{text:"The application payload size. Might be empty for a simple ACK or if the packet only includes MAC commands."})),l.a.createElement(P,r)),l.a.createElement(N.a.Group,{as:f.a,controlId:"formCodingRate"},l.a.createElement(N.a.Label,null,"Coding rate",l.a.createElement(A,{text:"The coding rate (CR) used for forward error correction (FEC)."})),l.a.createElement(N.a.Control,Object.assign({as:"select"},L(i),{className:"xxtext-primary xxborder-primary"}),l.a.createElement("option",{value:"4/5"},"4/5"),l.a.createElement("option",{value:"4/6"},"4/6"),l.a.createElement("option",{value:"4/7"},"4/7"),l.a.createElement("option",{value:"4/8"},"4/8")))),t.macCommands&&l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a.Row,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},l.a.createElement(N.a.Label,null,"MAC command"),l.a.createElement(C.a,{"aria-label":"MAC commands"},m))),l.a.createElement("br",null))))}var W=t(69),V=t(70),U=function(){function e(){Object(W.a)(this,e)}return Object(V.a)(e,null,[{key:"calculate",value:function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"4/5",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"auto",r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:8,i=Math.pow(2,a)/(1e3*t)*1e3,o=(c+4.25)*i,s=r?0:1,u="auto"===l&&125===+t&&+a>=11||!0===l?1:0,m=+n[2]-4,d=8+Math.max(Math.ceil((8*e-4*a+28+16-20*s)/(4*(a-2*u)))*(m+4),0),f=d*i;return o+f}}]),e}();function B(e,a){return e.toLocaleString("en-US",{minimumFractionDigits:a,maximumFractionDigits:a})}function X(e){var a=e.dr,t=e.airtime,n=t/.01/1e3,r=3e4/t,c=86400/r;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"Result-datarate"},l.a.createElement("span",{className:"Result-dr"},a.name,l.a.createElement(A,{text:a.notes,placement:"top"})),l.a.createElement("span",null,l.a.createElement("span",{className:"Result-sf"},"SF",a.sf),l.a.createElement("span",{className:"Result-unit Result-unit-bw"},"BW",l.a.createElement("br",null),a.bw))),l.a.createElement("div",{className:"Result-airtime"},l.a.createElement(O.a,{placement:"top",overlay:l.a.createElement(x.a,{id:"Result-dutycycle-help"},B(t,3)," milliseconds time on air")},l.a.createElement("div",null,l.a.createElement("span",null,B(t,1),l.a.createElement("span",{className:"Result-unit"},"ms"))))),l.a.createElement("div",{className:"Result-dutycycle"},l.a.createElement(O.a,{placement:"top",overlay:l.a.createElement(x.a,{id:"Result-dutycycle-help"},"If regional legal or LoRaWAN maximum duty cycles apply, then a 1% maximum duty cycle needs a ",l.a.createElement("em",null,"minimum")," of ",B(n,3)," seconds between ",l.a.createElement("em",null,"any")," subsequent packet starts in the same subband.")},l.a.createElement("div",null,l.a.createElement("div",null,B(n,1),l.a.createElement("span",{className:"Result-unit"},"sec")),l.a.createElement("div",null,B(Math.floor(3600/n),0),l.a.createElement("span",{className:"Result-unit"},"msg",l.a.createElement("br",null),"/hour"))))),l.a.createElement("div",{className:"Result-fairaccess"},l.a.createElement(O.a,{placement:"top",overlay:l.a.createElement(x.a,{id:"Result-dutycycle-help"},l.a.createElement("p",null,"The TTN Fair Access Policy allows for at most 30 seconds time on air per device, per 24 hours. An airtime of ",B(t,3),"\xa0ms thus yields a maximum of"," ",B(r,1)," messages."),l.a.createElement("p",null,"When transmitting all day, this translates to, ",l.a.createElement("em",null,"on average"),", a minimum of"," ",B(c,1)," seconds between the starts of two uplinks, or a maximum of"," ",B(r/24,1),"\xa0messages per hour."))},l.a.createElement("div",null,l.a.createElement("div",{className:"Result-fairaccess-messages"},B(86400/r,1),l.a.createElement("span",{className:"Result-unit"},"sec",l.a.createElement("br",null),"(avg)")),l.a.createElement("div",{className:"Result-fairaccess-messages-per-day"},B(Math.floor(r),0),l.a.createElement("span",{className:"Result-unit"},"msg",l.a.createElement("br",null),"/24h")),l.a.createElement("div",{className:"Result-fairaccess-messages-per-hour"},B(r/24,1),l.a.createElement("span",{className:"Result-unit"},"avg",l.a.createElement("br",null),"/hour"))))))}function G(e){var a=e.region,t=e.packetSize,n=e.codingRate;if(!n)return null;var r=a.dataRates.map((function(e,a){var r=U.calculate(t,e.sf,e.bw,n);return l.a.createElement("div",{key:e.name,className:"Results-result Results-result-".concat(a%2?"odd":"even")},l.a.createElement(X,{dr:e,airtime:r}))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"Results-grid Results-grid-".concat(r.length)},l.a.createElement("div",{className:"Results-legend"},l.a.createElement("div",null,"data rate"),l.a.createElement("div",null,"airtime"),l.a.createElement("div",null,"1%\xa0max duty\xa0cycle"),l.a.createElement("div",null,"fair access policy")),r))}t(184);function $(e){var a=e.children,t=Object(n.useRef)(null),r=Object(n.useState)(!1),c=Object(u.a)(r,2),i=c[0],o=c[1],s=Object(n.useState)(!1),m=Object(u.a)(s,2),d=m[0],f=m[1],E=Object(n.useState)({width:-1,height:-1}),v=Object(u.a)(E,1)[0],p=function(e){var a=t.current;a&&a.scrollBy(e,0)};return Object(n.useEffect)((function(){var e=t.current,a=function(){if(e){var a=e.scrollLeft>0,t=e.scrollWidth-e.offsetWidth>e.scrollLeft+1;o(a),f(t)}else console.log("No scroll element")};if(e)return a(),window.addEventListener("resize",a),e.addEventListener("scroll",a),function(){e.removeEventListener("scroll",a),window.removeEventListener("resize",a)}}),[v]),l.a.createElement("div",{className:"d-flex justify-content-center align-items-center horizontal-scroll"+(i?" horizontal-scroll--overflow-left":"")+(d?" horizontal-scroll--overflow-right":"")},l.a.createElement("div",{className:"horizontal-scroll__button"+(i?" horizontal-scroll__button--enabled":""),onClick:function(){p(-40)}},"\u2039"),l.a.createElement("div",{className:"horizontal-scroll__content table-responsive",ref:t},a),l.a.createElement("div",{className:"horizontal-scroll__button"+(d?" horizontal-scroll__button--enabled":""),onClick:function(){p(40)}},"\u203a"))}function H(e,a,t){var n=a.pathname.split("/"),l=Object(u.a)(n,4),r=l[1],c=l[2],i=l[3],o=t.networks.find((function(e){return e.name===r})),s=o?o.regions.find((function(e){return e.name===c})):void 0;return{network:o,region:s,parameters:i}}function J(e,a,t,n,l,r){var c=H(0,a,t),i=void 0===r?c.parameters:r,o="/"+n.name+"/"+l.name+(i?"/"+i:"");a.pathname!==o?e.replace(o):console.log("No URL change needed; ".concat(o))}function K(e){var a=Object(n.useState)(null),t=Object(u.a)(a,2),r=t[0],c=t[1],i=Object(n.useState)(null),o=Object(u.a)(i,2),s=o[0],m=o[1],d=J.bind(null,e.history,e.location,e.config),E=H(e.history,e.location,e.config),p=E.network,g=E.region,h=E.parameters;if(!p){var b=e.config.networks[0],z=b.regions.find((function(e){return e.name===b.defaultRegion}));return d(b,z),null}if(!g){var j=p.regions.find((function(e){return e.name===p.defaultRegion}));return d(p,j),null}return l.a.createElement(l.a.Fragment,null,l.a.createElement(v.a,null,l.a.createElement(f.a,null,l.a.createElement($,null,l.a.createElement(R.a,null,p.regions.map((function(e){return l.a.createElement(y.a,{variant:"outline-primary",size:"sm",active:e.name===g.name,disabled:!e.dataRates,key:e.name,onClick:function(){return function(e){console.log("region",e),d(p,e)}(e)}},e.label)})))))),l.a.createElement(v.a,null,l.a.createElement("hr",null)),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"auto"},l.a.createElement(_,{userConfig:h,setUserConfig:function(e){console.log("URL",e),d(p,g,e)},setPacketSize:function(e){console.log("packet size",r,e),c(e)},setCodingRate:function(e){console.log("coding rate",s,e),m(e)}}))),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},l.a.createElement("h2",null,p.title," ",g.label))),l.a.createElement(v.a,{className:"justify-content-sm-center"},l.a.createElement(f.a,null,l.a.createElement("hr",null),l.a.createElement(G,{region:g,packetSize:r,codingRate:s}),l.a.createElement("hr",null))),l.a.createElement(v.a,{className:"justify-content-md-center"},l.a.createElement(f.a,{md:"8"},g.description&&l.a.createElement(w.a,{source:g.description}))))}function Q(){var e="/lorawan-airtime-ui/config.json",a=Object(n.useState)("Loading configuration..."),t=Object(u.a)(a,2),r=t[0],c=t[1],i=Object(n.useState)({}),m=Object(u.a)(i,2),p=m[0],y=m[1];return Object(n.useEffect)((function(){var a=!1;return function(){var t=Object(s.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.a.get(e);case 3:n=t.sent.data,a||(c(null),y(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),c("Failed to load configuration ".concat("/lorawan-airtime-ui"," ").concat(e,": ").concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}()(),function(){a=!0}}),[e]),l.a.createElement(h.a,{basename:"/lorawan-airtime-ui"},l.a.createElement(E.a,{fluid:!0,className:"App"},l.a.createElement(v.a,null,l.a.createElement(f.a,null,l.a.createElement("h1",null,"LoRaWAN 1.0.x airtime calculator"),l.a.createElement("p",null,r))),p.networks&&l.a.createElement(b.a,{render:function(e){return l.a.createElement(K,Object.assign({},e,{config:p}))}}),l.a.createElement(g.a,{href:"https://github.com/avbentem/lorawan-airtime-ui"})))}t(187),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,a,t){e.exports=t(188)},99:function(e,a,t){}},[[76,1,2]]]);
//# sourceMappingURL=main.ff0f75c5.chunk.js.map